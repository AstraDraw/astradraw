# Astradraw - Self-hosted Excalidraw Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# DOMAIN CONFIGURATION
# =============================================================================

# Your domain for Excalidraw (e.g., draw.example.com or IP address)
APP_DOMAIN=localhost

# Protocol to use (http or https)
# Use 'http' for local testing, 'https' for production with SSL
APP_PROTOCOL=http

# Email for Let's Encrypt certificates (uncomment when using HTTPS)
# ACME_EMAIL=your-email@example.com

# =============================================================================
# STORAGE BACKEND CONFIGURATION
# =============================================================================

# Storage backend type: 's3' (MinIO/S3) or 'keyv' (PostgreSQL/MongoDB)
# Recommended: s3 for blob storage (scenes, rooms, files)
STORAGE_BACKEND=s3

# =============================================================================
# S3/MINIO CONFIGURATION (when STORAGE_BACKEND=s3)
# =============================================================================

# S3 bucket name for storing scenes, rooms, and files
S3_BUCKET=excalidraw

# S3 region (can be any value for MinIO)
S3_REGION=us-east-1

# MinIO credentials are stored in secrets/ directory:
#   secrets/minio_access_key  - MinIO root user (e.g., "minioadmin")
#   secrets/minio_secret_key  - MinIO root password (min 8 characters)
#
# Create these files:
#   echo "minioadmin" > secrets/minio_access_key
#   openssl rand -base64 32 > secrets/minio_secret_key

# =============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# =============================================================================
# PostgreSQL is used for:
# - Keyv storage backend (when STORAGE_BACKEND=keyv)
# - Future: Comments system, user management

POSTGRES_USER=excalidraw
POSTGRES_PASSWORD=your_secure_postgres_password
POSTGRES_DB=excalidraw

# pgAdmin (database admin UI) - only used with --profile admin
PGADMIN_EMAIL=admin@example.com
PGADMIN_PASSWORD=your_admin_password

# =============================================================================
# DATABASE CONFIGURATION (MongoDB - alternative)
# =============================================================================
# To use MongoDB instead, uncomment below and update docker-compose.yml

# MONGO_USER=excalidraw
# MONGO_PASSWORD=your_secure_password_here
# MONGO_EXPRESS_USER=admin
# MONGO_EXPRESS_PASSWORD=your_admin_password_here

# =============================================================================
# GIPHY CONFIGURATION (for Stickers & GIFs sidebar)
# =============================================================================

# GIPHY API Key for GIF/sticker search functionality
# Get your free API key at: https://developers.giphy.com/
# 1. Create an account at developers.giphy.com
# 2. Click "Create an App"
# 3. Select "API" (not SDK)
# 4. Copy your API key here
#
# Docker Secrets Support:
# Instead of setting GIPHY_API_KEY directly, you can use Docker secrets:
#   1. Create a secret file: echo "your_api_key" > secrets/giphy_api_key
#   2. Set VITE_APP_GIPHY_API_KEY_FILE=/run/secrets/giphy_api_key
#
GIPHY_API_KEY=your_giphy_api_key_here

# =============================================================================
# KINESCOPE CONFIGURATION (for Talktrack board recordings)
# =============================================================================

# Kinescope API Key for video upload and playback
# Get your API key at: https://app.kinescope.io/
# 1. Log in to your Kinescope account
# 2. Go to Settings -> API
# 3. Create or copy your API key
#
# SECURITY: These credentials are used ONLY by the storage backend service.
# The frontend automatically proxies all Talktrack requests through the storage
# backend, keeping your API key secure and never exposed to the browser.
#
# Docker Secrets Support:
# Instead of setting KINESCOPE_API_KEY directly, you can use Docker secrets:
#   1. Create a secret file: echo "your_api_key" > secrets/kinescope_api_key
#   2. Set KINESCOPE_API_KEY_FILE=/run/secrets/kinescope_api_key (in docker-compose.yml)
#
KINESCOPE_API_KEY=your_kinescope_api_key_here

# Kinescope Project ID (parent folder for uploaded recordings)
# This is the folder/project where all Talktrack recordings will be stored
# Find this in your Kinescope dashboard URL: https://app.kinescope.io/projects/{PROJECT_ID}
#
# Docker Secrets Support:
# Instead of setting KINESCOPE_PROJECT_ID directly, you can use Docker secrets:
#   1. Create a secret file: echo "your_project_id" > secrets/kinescope_project_id
#   2. Set KINESCOPE_PROJECT_ID_FILE=/run/secrets/kinescope_project_id (in docker-compose.yml)
#
KINESCOPE_PROJECT_ID=your_project_id_here

# =============================================================================
# AUTHENTICATION (OIDC / Authentik)
# =============================================================================
# Configure OIDC for user authentication with Authentik or any OIDC provider

# OIDC Issuer URL (your Authentik application URL)
# Example: https://auth.yourdomain.com/application/o/astradraw/
OIDC_ISSUER_URL=

# OIDC Client ID (from Authentik provider configuration)
OIDC_CLIENT_ID=

# OIDC Client Secret (from Authentik provider configuration)
OIDC_CLIENT_SECRET=

# JWT Secret for session tokens (generate with: openssl rand -base64 32)
JWT_SECRET=change-me-in-production

# =============================================================================
# DEX OIDC PROVIDER (for testing)
# =============================================================================
# A lightweight OIDC provider is included for testing OAuth flows.
# Start it with: docker-compose --profile oidc up -d
#
# Test users (defined in dex-config.yaml):
#   - admin@example.com / admin123
#   - user@example.com / user123
#
# To use Dex for testing, set these values:
# OIDC_ISSUER_URL=https://auth.${APP_DOMAIN}/dex
# OIDC_CLIENT_ID=astradraw
# OIDC_CLIENT_SECRET=astradraw-secret-change-in-production
#
# Make sure to update dex-config.yaml with your APP_DOMAIN!

# =============================================================================
# LOCAL AUTHENTICATION (Default Admin User)
# =============================================================================
# When OIDC is not configured, local authentication is enabled by default
# with an admin user. You can customize the credentials below.

# Enable/disable local authentication (default: true when OIDC not configured)
# ENABLE_LOCAL_AUTH=true

# Admin username (default: admin)
ADMIN_USERNAME=admin

# Admin password (default: admin) - CHANGE THIS IN PRODUCTION!
ADMIN_PASSWORD=admin

# Admin email (default: admin@localhost)
ADMIN_EMAIL=admin@localhost

# =============================================================================
# OPTIONAL CONFIGURATION
# =============================================================================

# Storage backend log level (debug, verbose, log, warn, error)
# STORAGE_LOG_LEVEL=warn

# Maximum payload size for scenes/images
# STORAGE_BODY_LIMIT=50mb

