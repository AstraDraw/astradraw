---
description: "AstraDraw project overview - minimal context for all chats"
alwaysApply: true
---

# AstraDraw Project Overview

AstraDraw is a self-hosted Excalidraw fork with enterprise features: user authentication (OIDC/local), workspaces, collaboration, video recordings (Talktrack), and presentation mode.

## Tech Stack

| Layer | Technology |
|-------|------------|
| Frontend | React, Vite, TypeScript, Jotai |
| Backend | NestJS, Prisma, PostgreSQL |
| Storage | S3/MinIO via `IStorageService` abstraction |
| Realtime | Socket.io room server |
| Routing | Traefik (HTTPS, path-based, sticky sessions) |
| Auth | JWT in HTTP-only cookies, OIDC support |
| Infrastructure | Docker, secrets via `_FILE` env pattern |

**Important:** `frontend/`, `backend/`, `room-service/` are separate git repositories.

## Documentation

**Start here:** `/docs/README.md` - Full documentation index.

| Category | Path |
|----------|------|
| Getting Started | `/docs/getting-started/` |
| Architecture | `/docs/architecture/` |
| Features | `/docs/features/` |
| Deployment | `/docs/deployment/` |
| Guides | `/docs/guides/` |
| Troubleshooting | `/docs/troubleshooting/` |
| Planning | `/docs/planning/` |

## Key Invariants

### Authentication
- JWT stored only in HTTP-only cookies (never localStorage)
- OIDC user linking: match by OIDC ID → fallback to email → create new

### Data Model
- Each new user gets a default PERSONAL workspace (ADMIN role)
- Workspace types: PERSONAL (no collaboration) vs SHARED (full collaboration)
- Role hierarchy: ADMIN > MEMBER > VIEWER

### Infrastructure
- Traefik routes: `/` → frontend, `/socket.io` → room, `/api` → backend
- Use `getSecret()` / `getSecretOrThrow()` for Docker secrets
- HTTPS required in production (Web Crypto API needs secure context)

## Quick Start

```bash
just dev          # Start with hot-reload
just dev-status   # Check status
just check    # Run all checks
```

Access: `https://draw.local`
